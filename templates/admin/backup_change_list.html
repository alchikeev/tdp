{% extends "admin/base_site.html" %}
{% load static %}

{% block breadcrumbs %}
<div class="breadcrumbs">
  <a href="{% url 'admin:index' %}">Главная</a>
  &rsaquo; Резервные копии
</div>
{% endblock %}

{% block content %}
<h1>Резервные копии</h1>

{% if messages %}
  <ul class="messagelist">
    {% for message in messages %}
      <li class="{{ message.tags }}">{{ message }}</li>
    {% endfor %}
  </ul>
{% endif %}

<div class="module">
  <h2>Выгрузка</h2>
  <p>Собрать архив с базой и медиа.</p>
  <p>
    <a class="button" href="{% url 'admin:backup_backup_download' %}">Скачать архив</a>
  </p>
</div>

<div class="module">
  <h2>Восстановление</h2>
  <form method="post" action="{% url 'admin:backup_backup_restore' %}" enctype="multipart/form-data">
    {% csrf_token %}
    <p>
      <input type="file" name="archive" accept=".zip" required>
    </p>
    <p>
      <button type="submit" class="button default">Загрузить и восстановить</button>
    </p>
    <p class="help">
      Ожидается файл вида <code>TDP_YYYYMMDD.zip</code>, содержащий папки <code>data/</code> и <code>media/</code>.
    </p>
  </form>
</div>
{% endblock %}
